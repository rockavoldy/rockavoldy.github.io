<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Ketika maintenance repository yang sudah besar, untuk deployment ini tidak bisa langsung merge dari branch dev ke branch master. Artikel ini berisi langkah-langkah untuk apply commit tertentu dari branch dev ke staging atau master. "><link rel=canonical href=https://akhmad.id/blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/><title>Ketika Branch Staging Dan Dev Sudah Tidak Sejalan | Akhmad</title><link rel=stylesheet type=text/css href=https://akhmad.id/assets/css/tailwind.css><link rel=stylesheet type=text/css href="https://fonts.googleapis.com/css?family=Fira+Sans:400,700&display=swap"><link rel=stylesheet type=text/css href="https://fonts.googleapis.com/css?family=Fira+Code:400,700&display=swap"><link rel=icon type=image/ico href=https://akhmad.id/assets/favicon.ico><meta property="og:title" content="Ketika Branch Staging Dan Dev Sudah Tidak Sejalan"><meta property="og:description" content="Ketika maintenance repository yang sudah besar, untuk deployment ini tidak bisa langsung merge dari branch dev ke branch master. Artikel ini berisi langkah-langkah untuk apply commit tertentu dari branch dev ke staging atau master."><meta property="og:type" content="article"><meta property="og:url" content="https://akhmad.id/blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-04-29T05:51:58+07:00"><meta property="article:modified_time" content="2022-04-29T05:51:58+07:00"><meta property="og:site_name" content="Akhmad Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ketika Branch Staging Dan Dev Sudah Tidak Sejalan"><meta name=twitter:description content="Ketika maintenance repository yang sudah besar, untuk deployment ini tidak bisa langsung merge dari branch dev ke branch master. Artikel ini berisi langkah-langkah untuk apply commit tertentu dari branch dev ke staging atau master."></head><body class="antialiased font-sans bg-white text-slate-900 dark:bg-slate-800 dark:text-white"><div class="relative min-h-screen"><div class=pb-10><nav id=nav__container class="mx-auto w-full px-4 md:px-6 py-2 md:py-3 flex flex-wrap items-center justify-between drop-shadow-xl bg-white dark:bg-slate-800"><div class="text-slate-800 dark:text-white mr-6 w-fit"><div class="flex flex-col"><a href=https://akhmad.id/ class="font-semibold text-xl hover:text-slate-700 dark:hover:text-slate-300">Akhmad</a>
<span class="text-xs sm:text-sm">Stories, Build logs, Ideas</span></div></div><div class="flex flex-row"><div class="flex flex-row self-start"><div class="mr-2 md:ml-2"><a class="font-semibold uppercase hover:text-slate-600 dark:hover:text-slate-300" href=../../now/ aria-label=Now>Now</a></div><div class=mx-2><a class="font-semibold uppercase hover:text-slate-600 dark:hover:text-slate-300" href=../../blog/ aria-label="Blog posts">Blog</a></div></div><div class="mx-3 lg:ml-8 self-end"><button id=dark_mode_toggle aria-label="Switch for Dark mode and Light mode"><svg class="text-slate-800 dark:text-white hover:text-slate-700 dark:hover:text-slate-300 fill-current h-6 w-6" id="btn_dark" viewBox="0 0 24 24"><path d="M14 2c1.82.0 3.53.5 5 1.35C16.01 5.08 14 8.3 14 12s2.01 6.92 5 8.65C17.53 21.5 15.82 22 14 22 8.48 22 4 17.52 4 12S8.48 2 14 2z"/></svg><svg class="text-slate-800 dark:text-white hover:text-slate-700 dark:hover:text-slate-300 fill-current h-6 w-6 hidden" id="btn_light" viewBox="0 0 24 24"><path d="M12 7c-2.76.0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55.0 1-.45 1-1s-.45-1-1-1H2c-.55.0-1 .45-1 1s.45 1 1 1zm18 0h2c.55.0 1-.45 1-1s-.45-1-1-1h-2c-.55.0-1 .45-1 1S19.45 13 20 13zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1S11 19.45 11 20zM5.99 4.58c-.39-.39-1.03-.39-1.41.0-.39.39-.39 1.03.0 1.41l1.06 1.06c.39.39 1.03.39 1.41.0s.39-1.03.0-1.41L5.99 4.58zM18.36 16.95c-.39-.39-1.03-.39-1.41.0-.39.39-.39 1.03.0 1.41l1.06 1.06c.39.39 1.03.39 1.41.0.39-.39.39-1.03.0-1.41l-1.06-1.06zM19.42 5.99c.39-.39.39-1.03.0-1.41-.39-.39-1.03-.39-1.41.0l-1.06 1.06c-.39.39-.39 1.03.0 1.41s1.03.39 1.41.0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03.0-1.41-.39-.39-1.03-.39-1.41.0l-1.06 1.06c-.39.39-.39 1.03.0 1.41s1.03.39 1.41.0l1.06-1.06z"/></svg></button></div></div></nav><main><header><div class="mt-6 md:mt-14 lg:mt-20"><div class="max-w-xl md:max-w-3xl xl:max-w-4xl mx-auto text-center px-6"><h1 class="text-3xl sm:text-5xl leading-tight font-sans font-bold mb-2 text-slate-800 dark:text-slate-100">Ketika Branch Staging Dan Dev Sudah Tidak Sejalan</h1><p class="text-slate-700 dark:text-slate-200"><time datetime=2022-04-29 class="text-slate-900 dark:text-slate-100 text-xs mb-2 uppercase">Friday, 29 April 2022</time></p></div></div></header><article class="max-w-xl md:max-w-2xl xl:max-w-4xl mx-auto px-6 sm:px-12 pt-12"><div class="prose lg:prose-lg dark:prose-invert max-w-xl md:max-w-2xl xl:max-w-4xl"><p>Saat ini, di tempat saya sekarang dipercaya untuk jadi maintainer salah satu project dengan git history yang sudah lama. Mengurus deployment ke training server untuk test fitur-fitur atau fix atau improvement, dan melakukan deployment ke live server.</p><p>Masalah datang ketika branch master (live server) dan branch dev (training server) ini sudah tidak sejalan, jika melakukan branching dari dev lalu merge ke branch master, merge conflict-nya ini terlalu banyak untuk di solve 1-1<figure><a href=../../blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/img/git-diff-shortstat.png><img loading=lazy srcset="https://akhmad.id/blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/img/git-diff-shortstat_huba121aad1bb4b28b3609e1e9bf97aa59_22553_320x0_resize_box_3.png 320w,
https://akhmad.id/blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/img/git-diff-shortstat_huba121aad1bb4b28b3609e1e9bf97aa59_22553_600x0_resize_box_3.png 600w,
https://akhmad.id/blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/img/git-diff-shortstat.png 1200w" src=../../blog/ketika-branch-staging-dan-dev-sudah-tidak-sejalan/img/git-diff-shortstat_huba121aad1bb4b28b3609e1e9bf97aa59_22553_600x0_resize_box_3.png alt="ketika compare branch dev dan branch master"></a></figure><em>Ketika compare branch dev dan branch master</em></p><p>Mungkin ini hanya terjadi di tempat saya sekarang, atau mungkin issue ini sudah jadi issue umum ketika maintenance project lama dengan codebase yang besar, entahlah.</p><blockquote><p>dan pertanyaan 2 miliar-nya adalah, <strong>bagaimana untuk solve case seperti ini?</strong></p></blockquote><p>Please welcome <strong>git cherry-pick</strong></p><p>Simplenya, siapkan dulu commit-commit dari changes yang mau di-apply, bisa di save dulu ke note mungkin. Lalu buat branch baru dari branch staging, checkout ke branch baru ini, dan <code>git cherry-pick &lt;commit-hash></code> nya 1-1 dari commit paling awal (terlama sampai terbaru) sambil diliat tiap-tiap cherry-picknya ini jika ada conflict.</p><p>Penjelasan panjangnya, git cherry-pick biasa ini digunakan untuk mengambil commit-commit tertentu, jadi</p><ol><li>Siapkan commit-commit yang akan diambil dari branch dev, misal untuk mengambil fitur A, siapkan commit-commitnya dari ketika pertama fitur A dibuat</li><li>Buat branch baru dari branch staging, pastikan sudah melakukan <code>git pull</code> sebelum melakukan branching</li><li><code>git checkout</code> ke branch baru hasil branching dari staging</li><li><code>git cherry-pick</code> satu per satu commit yang sudah disiapkan tadi dari commit paling awal sampai terbaru. cherry-pick satu per satu ini agar bisa cek juga ketika ada conflict</li><li>Jika semua commit sudah ter-apply, saatnya cek dengan <code>git diff &lt;branch dev> -- folder/file yang diubah</code></li><li>Hasil pada poin 5 ini akan kosoong jika branch file yang dibandingkan ini dengan file dari branch dev sudah sama, berarti process cherry-pick untuk apply commit-commit-nya ini sudah sesuai. Atau jika ada output, bisa di cek sekaligus jika perbedaannya itu karena ada commit yang kurang, atau tidak berhubungan dengan fitur A ini.</li><li>Setelah dipastikan aman, saatnya create Merge Request dari branch ini ke branch <code>staging</code>, harus-nya sudah tidak ada merge conflict lagi. Setelah review aman, merge MR ini, dan buat merge request baru dari <code>staging</code> ke branch <code>master</code></li></ol><p><strong>Note:</strong></p><blockquote><ul><li>Mungkin ada yang bingung kenapa sampai ada 3 branch utama <code>master</code>, <code>staging</code>, dan <code>dev</code>, branch <code>staging</code> di tempat saya sekarang digunakan untuk menampung dulu hasil cherry-pick dari branch <code>dev</code>, lalu setelah semua aman, baru di merge ke branch <code>master</code>, jadi branch <code>staging</code> ini akan selalu sama dengan branch <code>master</code> dan bisa langsung di merge tanpa ada conflict. Berbeda dengan branch <code>dev</code>, biasanya banyak fitur yang telah dikembangkan tidak jadi digunakan di live, dan traffic branch <code>dev</code> ini akan selalu ramai untuk testing, karena itu tidak bisa merge langsung dari <code>dev</code> ke <code>staging</code> atau <code>master</code> tanpa conflict.</li><li>Adanya branch <code>staging</code> ini juga mempermudah proses revert commit jika misal deployment saat itu ada fatal error, dan harus melakukan rollback seluruh changes pada deployment saat itu.</li></ul></blockquote></div></article></main><br><br></div><div class="bottom-0 absolute w-full h-10 text-center"><footer class="text-slate-700 dark:text-slate-200 text-xs leading-normal flex flex-wrap justify-between mx-auto max-w-2xl px-4"><div class="w-full my-4"><p>Build with &#9829; in
<strong>Bandung</strong></p></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2"></ul></nav></div></footer></div></div><script>const svgDark=document.getElementById("btn_dark"),svgLight=document.getElementById("btn_light"),btnDarkMode=document.getElementById("dark_mode_toggle");localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),svgDark.classList.add("hidden"),svgLight.classList.remove("hidden"),localStorage.theme="dark"):(document.documentElement.classList.remove("dark"),svgLight.classList.add("hidden"),svgDark.classList.remove("hidden"),localStorage.theme="light"),btnDarkMode.onclick=function(){localStorage.theme==="dark"?(document.documentElement.classList.remove("dark"),svgLight.classList.add("hidden"),svgDark.classList.remove("hidden"),localStorage.theme="light"):(document.documentElement.classList.add("dark"),svgDark.classList.add("hidden"),svgLight.classList.remove("hidden"),localStorage.theme="dark")}</script><script async src=https://umami.akhmad.id/script.js data-website-id=5818ae25-1b72-473c-a58e-4f35e78ce30f></script></body></html>