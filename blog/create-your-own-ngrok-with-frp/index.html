<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Setup your reverse-tunneling service like ngrok in your server using Fast Reverse Proxy (FRP). "><link rel=canonical href=https://akhmad.id/blog/create-your-own-ngrok-with-frp/><title>Create Your Own ngrok With FRP | Akhmad</title><link rel=stylesheet type=text/css href=https://akhmad.id/assets/css/tailwind.css><link rel=stylesheet type=text/css href="https://fonts.googleapis.com/css?family=Fira+Sans:400,700&display=swap"><link rel=stylesheet type=text/css href="https://fonts.googleapis.com/css?family=Fira+Code:400,700&display=swap"><link rel=icon type=image/ico href=https://akhmad.id/assets/favicon.ico><meta property="og:title" content="Create Your Own ngrok With FRP"><meta property="og:description" content="Setup your reverse-tunneling service like ngrok in your server using Fast Reverse Proxy (FRP)."><meta property="og:type" content="article"><meta property="og:url" content="https://akhmad.id/blog/create-your-own-ngrok-with-frp/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-08-21T09:56:29+07:00"><meta property="article:modified_time" content="2023-08-21T09:56:29+07:00"><meta property="og:site_name" content="Akhmad Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Create Your Own ngrok With FRP"><meta name=twitter:description content="Setup your reverse-tunneling service like ngrok in your server using Fast Reverse Proxy (FRP)."></head><body class="antialiased font-sans bg-white text-slate-900 dark:bg-slate-800 dark:text-white"><div class="relative min-h-screen"><div class=pb-10><nav id=nav__container class="mx-auto w-full px-4 md:px-6 py-2 md:py-3 flex flex-wrap items-center justify-between drop-shadow-xl bg-white dark:bg-slate-800"><div class="text-slate-800 dark:text-white mr-6 w-fit"><div class="flex flex-col"><a href=https://akhmad.id/ class="font-semibold text-xl hover:text-slate-700 dark:hover:text-slate-300">Akhmad</a>
<span class="text-xs sm:text-sm">Stories, Build logs, Ideas</span></div></div><div class="flex flex-row"><div class="flex flex-row self-start"><div class="mr-2 md:ml-2"><a class="font-semibold uppercase hover:text-slate-600 dark:hover:text-slate-300" href=../../now/ aria-label=Now>Now</a></div><div class=mx-2><a class="font-semibold uppercase hover:text-slate-600 dark:hover:text-slate-300" href=../../blog/ aria-label="Blog posts">Blog</a></div></div><div class="mx-3 lg:ml-8 self-end"><button id=dark_mode_toggle aria-label="Switch for Dark mode and Light mode"><svg class="text-slate-800 dark:text-white hover:text-slate-700 dark:hover:text-slate-300 fill-current h-6 w-6" id="btn_dark" viewBox="0 0 24 24"><path d="M14 2c1.82.0 3.53.5 5 1.35C16.01 5.08 14 8.3 14 12s2.01 6.92 5 8.65C17.53 21.5 15.82 22 14 22 8.48 22 4 17.52 4 12S8.48 2 14 2z"/></svg><svg class="text-slate-800 dark:text-white hover:text-slate-700 dark:hover:text-slate-300 fill-current h-6 w-6 hidden" id="btn_light" viewBox="0 0 24 24"><path d="M12 7c-2.76.0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55.0 1-.45 1-1s-.45-1-1-1H2c-.55.0-1 .45-1 1s.45 1 1 1zm18 0h2c.55.0 1-.45 1-1s-.45-1-1-1h-2c-.55.0-1 .45-1 1S19.45 13 20 13zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1S11 19.45 11 20zM5.99 4.58c-.39-.39-1.03-.39-1.41.0-.39.39-.39 1.03.0 1.41l1.06 1.06c.39.39 1.03.39 1.41.0s.39-1.03.0-1.41L5.99 4.58zM18.36 16.95c-.39-.39-1.03-.39-1.41.0-.39.39-.39 1.03.0 1.41l1.06 1.06c.39.39 1.03.39 1.41.0.39-.39.39-1.03.0-1.41l-1.06-1.06zM19.42 5.99c.39-.39.39-1.03.0-1.41-.39-.39-1.03-.39-1.41.0l-1.06 1.06c-.39.39-.39 1.03.0 1.41s1.03.39 1.41.0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03.0-1.41-.39-.39-1.03-.39-1.41.0l-1.06 1.06c-.39.39-.39 1.03.0 1.41s1.03.39 1.41.0l1.06-1.06z"/></svg></button></div></div></nav><main><header><div class="mt-6 md:mt-14 lg:mt-20"><div class="max-w-xl md:max-w-3xl xl:max-w-4xl mx-auto text-center px-6"><h1 class="text-3xl sm:text-5xl leading-tight font-sans font-bold mb-2 text-slate-800 dark:text-slate-100">Create Your Own ngrok With FRP</h1><p class="text-slate-700 dark:text-slate-200"><time datetime=2023-08-21 class="text-slate-900 dark:text-slate-100 text-xs mb-2 uppercase">Monday, 21 August 2023</time></p></div></div></header><article class="max-w-xl md:max-w-2xl xl:max-w-4xl mx-auto px-6 sm:px-12 pt-12"><div class="prose lg:prose-lg dark:prose-invert max-w-xl md:max-w-2xl xl:max-w-4xl"><h2 id=introduction>Introduction</h2><p>Most Web developer in this time will somehow have used or at least known app called <a href=https://ngrok.com>ngrok</a>. For you who just know this app, it is basically a tool to &ldquo;publish&rdquo; your app that are deployed on local to the internet, some call this process &ldquo;reverse-tunneling&rdquo;. It&rsquo;s a nice tool, i have used it in the past when i need to show my friend/coworker about new feature, but don&rsquo;t have any server ready, or in case in the company, you just want to quickly show it without pushing the dirty-code to the repository and follow the process of the deployment to staging.</p><p>But, since reverse-tunneling need a server to forward requests from the intenet to your app, it will have limitation. And for ngrok, it can only open 1 connection for 8 hours, and the domain will always be randomly-generated, except you pay for their service. It can&rsquo;t satisfy my use-case, and since i don&rsquo;t use it regularly, it&rsquo;s hard for me to justify to pay for their service. So because of that issues, in the meantime, I use <a href=https://www.howtogeek.com/428413/what-is-reverse-ssh-tunneling-and-how-to-use-it/>SSH Reverse tunneling</a> while looking for the alternative tool that i can self-host on my server. Until i found <a href=https://github.com/fatedier/frp>fast-reverse-proxy (FRP)</a>.</p><h2 id=configuration>Configuration</h2><h3 id=server>Server</h3><p>First, we need to configure the app on the server. When you download the <a href=https://github.com/fatedier/frp/releases>frp tool from their release page</a>, it&rsquo;s a compressed file, you can extract it and you will see 2 binary, <code>frps</code> and <code>frpc</code>. Since we will configure the server first, you only need to use <code>frps</code> app, move it to <code>/usr/local/bin/</code> directory.</p><p>Now, create config file with name <code>frps.ini</code> and put it inside <code>/etc/</code>, and fill it with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#ff79c6>[</span>common<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>bind_port</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>7000</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>vhost_http_port</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>80</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>subdomain_host</span> <span style=color:#ff79c6>=</span> your.domain.tld
</span></span></code></pre></div><ul><li><code>bind_port</code>: will be used for the client (frpc) connect to this server.</li><li><code>subdomain_host</code>: will be used as a host domain, make sure your DNS already have A record for <code>*.your.domain.tld</code> to the server IP, so then when your client put <code>test</code> in the <code>subdomain</code> config, and visit <code>http://test.your.domain.tld</code>, it will be redirected to the client that have <code>subdomain</code> filled as <code>test</code>.</li><li><code>vhost_http_port</code>: this port will be used to accept request to the server, here i put <code>80</code>, then when someone access <code>test.your.domain.tld</code>, the service will catch the request, check if there is any client use <code>test</code> in their <code>subdomain</code>, when found, it will redirect the request to that client. This http_port can be changed to others like <code>8080</code> if you have another http server like nginx or caddy on the same server, then use reverse_proxy feature to forward request from your http server to FRPs</li></ul><p>Then run the server with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/usr/local/bin/frps -c /etc/frps.ini
</span></span></code></pre></div><p>It will run the reverse-proxy server for the client to connect.</p><h3 id=client>Client</h3><p>As for the client, you need to download at the same <a href=https://github.com/fatedier/frp/releases>release page</a>, there will be <code>frpc</code> app when you extract the compressed file, move it to <code>/usr/local/bin/</code> too.</p><p>Then, create config file with name <code>frpc.ini</code> and put inside <code>/etc/</code>, and fill it with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#ff79c6>[</span>common<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>server_addr</span> <span style=color:#ff79c6>=</span> &lt;your-server-ip-address&gt;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>server_port</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>7000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>[</span>test<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>type</span> <span style=color:#ff79c6>=</span> http
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>local_ip</span> <span style=color:#ff79c6>=</span> 127.0.0.1
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>local_port</span> <span style=color:#ff79c6>=</span> &lt;your-local-app-port&gt;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>subdomain</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>test</span>
</span></span></code></pre></div><ul><li><code>server_addr</code>: is your server address where FRPs running, can put the IP Address, or the domain that are pointed to that IP Address</li><li><code>server_port</code>: this should be the same as <code>bind_port</code> configured in server</li><li><code>type</code>: is the type which your app is running, if it on local, just put <code>http</code> in there</li><li><code>local_ip</code>: is where the IP your app running</li><li><code>local_port</code>: is your listen port of your app, says yours running at port <code>8080</code>, then just fill it with <code>8080</code></li><li><code>subdomain</code>: is the subdomain that will be use to access this client app, here i put <code>test</code>, and when we visit <code>http://test.your.domain.tld</code>, it will be forwarded to the app running at <code>local_ip:local_port</code></li></ul><p>Now, same like the server, run the client with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/usr/local/bin/frpc -c /etc/frpc.ini
</span></span></code></pre></div><p>It will try forward the port you have been set in <code>test</code> section to your FRP Server. After you have done this, try to access <code>http://test.your.domain.tld</code> (<code>test</code> is taken from the subdomain you have set in Client, then followed by <code>your.domain.tld</code>, taken from the subdomain_host you have set in the FRP Server configuration).</p><p>If you want to implement https, see my <a href=https://gist.github.com/rockavoldy/c0aebe0ea394c2252c53021113a2aeca#http-server-reverse-proxy>caddyserver configuration here</a>.</p><p>You can also see my configuration with systemd service in <a href=https://gist.github.com/rockavoldy/c0aebe0ea394c2252c53021113a2aeca>this gist</a>. As for the complete configuration, you can always check the <a href=https://github.com/fatedier/frp>repository page here</a>.</p></div></article></main><br><br></div><div class="bottom-0 absolute w-full h-10 text-center"><footer class="text-slate-700 dark:text-slate-200 text-xs leading-normal flex flex-wrap justify-between mx-auto max-w-2xl px-4"><div class="w-full my-4"><p>Build with &#9829; in
<strong>Bandung</strong></p></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2"></ul></nav></div></footer></div></div><script>const svgDark=document.getElementById("btn_dark"),svgLight=document.getElementById("btn_light"),btnDarkMode=document.getElementById("dark_mode_toggle");localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),svgDark.classList.add("hidden"),svgLight.classList.remove("hidden"),localStorage.theme="dark"):(document.documentElement.classList.remove("dark"),svgLight.classList.add("hidden"),svgDark.classList.remove("hidden"),localStorage.theme="light"),btnDarkMode.onclick=function(){localStorage.theme==="dark"?(document.documentElement.classList.remove("dark"),svgLight.classList.add("hidden"),svgDark.classList.remove("hidden"),localStorage.theme="light"):(document.documentElement.classList.add("dark"),svgDark.classList.add("hidden"),svgLight.classList.remove("hidden"),localStorage.theme="dark")}</script><script async src=https://umami.akhmad.id/script.js data-website-id=5818ae25-1b72-473c-a58e-4f35e78ce30f></script></body></html>